#!/usr/bin/env bash

set -e

# Make sure the TRAVIS_COMMIT_RANGE is valid, by catching any errors and exiting.
if [ -z "$TRAVIS_COMMIT_RANGE" ] || ! git rev-list --quiet $TRAVIS_COMMIT_RANGE; then
  echo "Invalid commit range. Skipping check for doc only update"
  exit 0
fi

# Only run CI if an operator package was modified.
if ! git diff --name-only $TRAVIS_COMMIT_RANGE | \
  grep -qvE '(\.md)|(.travis.yml)|(OWNERS)|(Dockerfile)|(docs/)|(scripts/)'; then
    echo "Only doc files were updated, not running the CI."
    exit 0
fi
